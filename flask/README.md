Time spent: 4 hours on Saturday evening.

That leaves 1 hour to write tests, but I may need to stop there.